Домашнее задание к занятию "13. Системы мониторинга"
***

### Обязательные задания

7. **Запуск TICK-стэка**
   - Склонируйте репозиторий [influxdata/sandbox](https://github.com/influxdata/sandbox/tree/master).
   - Запустите TICK-стэк с помощью Docker и docker-compose.
   - Если контейнеры падают с ошибкой, установите для них режим `Z`, например `./data:/var/lib:Z`.

8. **Веб-интерфейс Chronograf**
   - Откройте веб-интерфейс по адресу: [http://localhost:8888](http://localhost:8888).
   - Перейдите во вкладку **Data explorer**.
   - Нажмите кнопку **Add a query**.
   - Выберите базу данных `telegraf.autogen`.
   - В разделе measurements выберите: `cpu -> host -> telegraf-getting-started`.
   - В fields выберите `usage_system`.
   - Внизу отобразится график утилизации CPU.
   - Поэкспериментируйте с запросом — изменяйте группировку и интервал наблюдений.
   - Сделайте скриншот графика утилизации CPU из веб-интерфейса.

9. **Добавление плагина Docker в Telegraf**
   - Изучите список telegraf inputs: [Telegraf inputs](https://github.com/influxdata/telegraf/tree/master/plugins/inputs).
   - Добавьте в конфигурацию Telegraf следующий плагин:

   ```toml
   [[inputs.docker]]
     endpoint = "unix:///var/run/docker.sock"
   ```

   - При необходимости отредактируйте `docker-compose.yml`, добавив volume и режим privileged для контейнера telegraf:

   ```yaml
   telegraf:
     image: telegraf:1.4.0
     privileged: true
     volumes:
       - ./etc/telegraf.conf:/etc/telegraf/telegraf.conf:Z
       - /var/run/docker.sock:/var/run/docker.sock:Z
     links:
       - influxdb
     ports:
       - "8092:8092/udp"
       - "8094:8094"
       - "8125:8125/udp"
   ```

   - Перезапустите контейнер telegraf.
   - Обновите веб-интерфейс Chronograf.
   - Сделайте скриншот списка измерений (measurements) в базе `telegraf.autogen`, где должны появиться метрики, связанные с Docker.
   - При желании изучите все метрики, которые собирает Telegraf.

***

### Дополнительное задание (со звездочкой *)

Вы устроились на работу в стартап. Нет возможности развернуть полноценную систему мониторинга, поэтому решаете написать простой Python 3 скрипт для сбора основных метрик сервера.

- Скрипт должен:
  - Собирать метрики из директории `/proc` (или других источников по желанию).
  - Записывать метрики в файл с именем по шаблону: `YY-MM-DD-awesome-monitoring.log` в директорию `/var/log`.
  - Каждая запись — JSON-строка с ключами:
    - `timestamp` — Unix timestamp (int)
    - `metric_1`, `metric_2`, ..., `metric_N` — метрики (минимум 4)
  - Скрипт должен запускаться каждую 1 минуту с помощью cron.

- Для задания нужно предоставить:
  - а) Рабочий код python3-скрипта.
  - б) Конфигурацию cron-расписания.
  - в) Пример лога с не менее чем 5 записями.

***

### Веб-интерфейс: Dashboard

1. Во вкладке **Dashboards** создайте собственный дашборд.
2. Добавьте отображение следующих метрик (или других по желанию):
   - Утилизация CPU
   - Используемая RAM
   - Используется пространство на дисках
   - Количество поднятых Docker контейнеров
   - Время работы (аптайм)
3. Проявите фантазию и настройте дашборд под свои нужды.

***

Так оформленное домашнее задание можно легко оформить в Markdown для удобства чтения и презентации. Если нужна помощь с кодом, конфигурацией или примерами, обращайтесь.

[1] https://github.com/DioRoman/10-monitoring-02-systems/blob/main/task.md
